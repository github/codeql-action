/** @license ms-rest-js
  * Copyright (c) Microsoft Corporation. All rights reserved.
  * Licensed under the MIT License. See License.txt and ThirdPartyNotices.txt in the project root for license information.
  */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).msRest={})}(this,(function(e){"use strict";function t(e){return e.toLowerCase()}function r(e){return!(!e||"object"!=typeof e)&&("function"==typeof e.rawHeaders&&"function"==typeof e.clone&&"function"==typeof e.get&&"function"==typeof e.set&&"function"==typeof e.contains&&"function"==typeof e.remove&&"function"==typeof e.headersArray&&"function"==typeof e.headerValues&&"function"==typeof e.headerNames&&"function"==typeof e.toJson)}var n=function(){function e(e){if(this._headersMap={},e)for(var t in e)this.set(t,e[t])}return e.prototype.set=function(e,r){this._headersMap[t(e)]={name:e,value:r.toString()}},e.prototype.get=function(e){var r=this._headersMap[t(e)];return r?r.value:void 0},e.prototype.contains=function(e){return!!this._headersMap[t(e)]},e.prototype.remove=function(e){var r=this.contains(e);return delete this._headersMap[t(e)],r},e.prototype.rawHeaders=function(){var e={};for(var t in this._headersMap){var r=this._headersMap[t];e[r.name.toLowerCase()]=r.value}return e},e.prototype.headersArray=function(){var e=[];for(var t in this._headersMap)e.push(this._headersMap[t]);return e},e.prototype.headerNames=function(){for(var e=[],t=this.headersArray(),r=0;r<t.length;++r)e.push(t[r].name);return e},e.prototype.headerValues=function(){for(var e=[],t=this.headersArray(),r=0;r<t.length;++r)e.push(t[r].value);return e},e.prototype.toJson=function(){return this.rawHeaders()},e.prototype.toString=function(){return JSON.stringify(this.toJson())},e.prototype.clone=function(){return new e(this.rawHeaders())},e}();function o(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function i(e){for(var t=atob(e),r=new Uint8Array(t.length),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r}for(var a=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var r=new Uint8Array(16);e.exports=function(){return t(r),r}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}})),s=[],u=0;u<256;++u)s[u]=(u+256).toString(16).substr(1);var l=function(e,t){var r=t||0,n=s;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")};var c=function(e,t,r){var n=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||a)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var i=0;i<16;++i)t[n+i]=o[i];return t||l(o)},f={msRestVersion:"2.1.0",HTTP:"http:",HTTPS:"https:",HTTP_PROXY:"HTTP_PROXY",HTTPS_PROXY:"HTTPS_PROXY",HttpConstants:{HttpVerbs:{PUT:"PUT",GET:"GET",DELETE:"DELETE",POST:"POST",MERGE:"MERGE",HEAD:"HEAD",PATCH:"PATCH"},StatusCodes:{TooManyRequests:429}},HeaderConstants:{AUTHORIZATION:"authorization",AUTHORIZATION_SCHEME:"Bearer",RETRY_AFTER:"Retry-After",USER_AGENT:"User-Agent"}},p="undefined"!=typeof process&&!!process.version&&!!process.versions&&!!process.versions.node;function h(e){var t={};return t.body=e.bodyAsText,t.headers=e.headers,t.status=e.status,t}function d(e){var t=e.clone();return t.headers&&t.headers.remove("authorization"),t}function y(e){return new RegExp("^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$","ig").test(e)}function m(){return c()}function v(e,t){return new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))}var g=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function b(e){return g.test(e)}function w(e,t,r){return e&&t?e.split(t).join(r||""):e}var E=function(){function e(e,t){void 0===e&&(e={}),this.modelMappers=e,this.isXML=t}return e.prototype.validateConstraints=function(e,t,r){var n=function(e,n){throw new Error('"'+r+'" with value "'+t+'" should satisfy the constraint "'+e+'": '+n+".")};if(e.constraints&&null!=t){var o=e.constraints,i=o.ExclusiveMaximum,a=o.ExclusiveMinimum,s=o.InclusiveMaximum,u=o.InclusiveMinimum,l=o.MaxItems,c=o.MaxLength,f=o.MinItems,p=o.MinLength,h=o.MultipleOf,d=o.Pattern,y=o.UniqueItems;if(null!=i&&t>=i&&n("ExclusiveMaximum",i),null!=a&&t<=a&&n("ExclusiveMinimum",a),null!=s&&t>s&&n("InclusiveMaximum",s),null!=u&&t<u&&n("InclusiveMinimum",u),null!=l&&t.length>l&&n("MaxItems",l),null!=c&&t.length>c&&n("MaxLength",c),null!=f&&t.length<f&&n("MinItems",f),null!=p&&t.length<p&&n("MinLength",p),null!=h&&t%h!=0&&n("MultipleOf",h),d){var m="string"==typeof d?new RegExp(d):d;"string"==typeof t&&null!==t.match(m)||n("Pattern",d)}y&&t.some((function(e,t,r){return r.indexOf(e)!==t}))&&n("UniqueItems",y)}},e.prototype.serialize=function(e,t,r){var n={},i=e.type.name;r||(r=e.serializedName),null!==i.match(/^Sequence$/gi)&&(n=[]),e.isConstant&&(t=e.defaultValue);var a=e.required,s=e.nullable;if(a&&s&&void 0===t)throw new Error(r+" cannot be undefined.");if(a&&!s&&null==t)throw new Error(r+" cannot be null or undefined.");if(!a&&!1===s&&null===t)throw new Error(r+" cannot be null.");if(null==t)n=t;else if(this.validateConstraints(e,t,r),null!==i.match(/^any$/gi))n=t;else if(null!==i.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/gi))n=function(e,t,r){if(null!=r)if(null!==e.match(/^Number$/gi)){if("number"!=typeof r)throw new Error(t+" with value "+r+" must be of type number.")}else if(null!==e.match(/^String$/gi)){if("string"!=typeof r.valueOf())throw new Error(t+' with value "'+r+'" must be of type string.')}else if(null!==e.match(/^Uuid$/gi)){if("string"!=typeof r.valueOf()||!y(r))throw new Error(t+' with value "'+r+'" must be of type string and a valid uuid.')}else if(null!==e.match(/^Boolean$/gi)){if("boolean"!=typeof r)throw new Error(t+" with value "+r+" must be of type boolean.")}else if(null!==e.match(/^Stream$/gi)){var n=typeof r;if(!("string"===n||"function"===n||r instanceof ArrayBuffer||ArrayBuffer.isView(r)||"function"==typeof Blob&&r instanceof Blob))throw new Error(t+" must be a string, Blob, ArrayBuffer, ArrayBufferView, or a function returning NodeJS.ReadableStream.")}return r}(i,r,t);else if(null!==i.match(/^Enum$/gi)){n=function(e,t,r){if(!t)throw new Error("Please provide a set of allowedValues to validate "+e+" as an Enum Type.");if(!t.some((function(e){return"string"==typeof e.valueOf()?e.toLowerCase()===r.toLowerCase():e===r})))throw new Error(r+" is not a valid value for "+e+". The valid values are: "+JSON.stringify(t)+".");return r}(r,e.type.allowedValues,t)}else null!==i.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/gi)?n=function(e,t,r){if(null!=t)if(null!==e.match(/^Date$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString().substring(0,10):new Date(t).toISOString().substring(0,10)}else if(null!==e.match(/^DateTime$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString():new Date(t).toISOString()}else if(null!==e.match(/^DateTimeRfc1123$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in RFC-1123 format.");t=t instanceof Date?t.toUTCString():new Date(t).toUTCString()}else if(null!==e.match(/^UnixTime$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.");t=function(e){if(!e)return;"string"==typeof e.valueOf()&&(e=new Date(e));return Math.floor(e.getTime()/1e3)}(t)}else if(null!==e.match(/^TimeSpan$/gi)){if(!b(t))throw new Error(r+' must be a string in ISO 8601 format. Instead was "'+t+'".');t=t}return t}(i,t,r):null!==i.match(/^ByteArray$/gi)?n=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");t=o(t)}return t}(r,t):null!==i.match(/^Base64Url$/gi)?n=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");t=function(e){if(!e)return;if(!(e instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(e,t){var r=e.length;for(;r-1>=0&&e[r-1]===t;)--r;return e.substr(0,r)}(o(e),"=").replace(/\+/g,"-").replace(/\//g,"_")}(t)}return t}(r,t):null!==i.match(/^Sequence$/gi)?n=function(e,t,r,n){if(!Array.isArray(r))throw new Error(n+" must be of type Array.");var o=t.type.element;if(!o||"object"!=typeof o)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+n+".");for(var i=[],a=0;a<r.length;a++)i[a]=e.serialize(o,r[a],n);return i}(this,e,t,r):null!==i.match(/^Dictionary$/gi)?n=function(e,t,r,n){if("object"!=typeof r)throw new Error(n+" must be of type object.");var o=t.type.value;if(!o||"object"!=typeof o)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+n+".");for(var i={},a=0,s=Object.keys(r);a<s.length;a++){var u=s[a];i[u]=e.serialize(o,r[u],n+"."+u)}return i}(this,e,t,r):null!==i.match(/^Composite$/gi)&&(n=function(e,t,r,n){var o;S(e,t)&&(t=P(e,t,r,"clientName"));if(null!=r){for(var i={},a=T(e,t,n),s=0,u=Object.keys(a);s<u.length;s++){var l=u[s],c=a[l];if(!c.readOnly){var f=void 0,p=i;if(e.isXML)f=c.xmlIsWrapped?c.xmlName:c.xmlElementName||c.xmlName;else{var h=R(c.serializedName);f=h.pop();for(var d=0,y=h;d<y.length;d++){var m=y[d];null==p[m]&&null!=r[l]&&(p[m]={}),p=p[m]}}if(null!=p){var v=""!==c.serializedName?n+"."+c.serializedName:n,g=r[l],b=S(e,t);b&&b.clientName===l&&null==g&&(g=t.serializedName);var w=e.serialize(c,g,v);void 0!==w&&null!=f&&(c.xmlIsAttribute?(p.$=p.$||{},p.$[f]=w):c.xmlIsWrapped?p[f]=((o={})[c.xmlElementName]=w,o):p[f]=w)}}}var E=t.type.additionalProperties;if(E){var _=Object.keys(a),O=function(t){_.every((function(e){return e!==t}))&&(i[t]=e.serialize(E,r[t],n+'["'+t+'"]'))};for(var x in r)O(x)}return i}return r}(this,e,t,r));return n},e.prototype.deserialize=function(e,t,r){if(null==t)return this.isXML&&"Sequence"===e.type.name&&!e.xmlIsWrapped&&(t=[]),void 0!==e.defaultValue&&(t=e.defaultValue),t;var n,o=e.type.name;return r||(r=e.serializedName),null!==o.match(/^Composite$/gi)?n=function(e,t,r,n){S(e,t)&&(t=P(e,t,r,"serializedName"));for(var o=T(e,t,n),i={},a=[],s=0,u=Object.keys(o);s<u.length;s++){var l=u[s],c=o[l],f=R(o[l].serializedName);a.push(f[0]);var p=c.serializedName,h=c.xmlName,d=c.xmlElementName,y=n;""!==p&&void 0!==p&&(y=n+"."+p);var m=c.headerCollectionPrefix;if(m){for(var v={},g=0,b=Object.keys(r);g<b.length;g++){var w=b[g];w.startsWith(m)&&(v[w.substring(m.length)]=e.deserialize(c.type.value,r[w],y)),a.push(w)}i[l]=v}else if(e.isXML)if(c.xmlIsAttribute&&r.$)i[l]=e.deserialize(c,r.$[h],y);else{var E=r[d||h||p];if(c.xmlIsWrapped)void 0===(E=(E=r[h])&&E[d])&&(E=[]);i[l]=e.deserialize(c,E,y)}else{for(var O=void 0,x=r,N=0,A=f;N<A.length;N++){var q=A[N];if(!x)break;x=x[q]}O=x;var C=t.type.polymorphicDiscriminator;C&&l===C.clientName&&null==O&&(O=t.serializedName);var D=void 0;Array.isArray(r[l])&&""===o[l].serializedName?(O=r[l],i=e.deserialize(c,O,y)):void 0===O&&void 0===c.defaultValue||(D=e.deserialize(c,O,y),i[l]=D)}}var I=t.type.additionalProperties;if(I){var U=function(e){for(var t in o){if(R(o[t].serializedName)[0]===e)return!1}return!0};for(var H in r)U(H)&&(i[H]=e.deserialize(I,r[H],n+'["'+H+'"]'))}else if(r)for(var M=0,j=Object.keys(r);M<j.length;M++){l=j[M];void 0!==i[l]||a.includes(l)||_(l)||(i[l]=r[l])}return i}(this,e,t,r):(this.isXML&&null!=t.$&&null!=t._&&(t=t._),null!==o.match(/^Number$/gi)?(n=parseFloat(t),isNaN(n)&&(n=t)):null!==o.match(/^Boolean$/gi)?n="true"===t||"false"!==t&&t:null!==o.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/gi)?n=t:null!==o.match(/^(Date|DateTime|DateTimeRfc1123)$/gi)?n=new Date(t):null!==o.match(/^UnixTime$/gi)?n=function(e){if(!e)return;return new Date(1e3*e)}(t):null!==o.match(/^ByteArray$/gi)?n=i(t):null!==o.match(/^Base64Url$/gi)?n=function(e){if(!e)return;if(e&&"string"!=typeof e.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return i(e=e.replace(/\-/g,"+").replace(/\_/g,"/"))}(t):null!==o.match(/^Sequence$/gi)?n=function(e,t,r,n){var o=t.type.element;if(!o||"object"!=typeof o)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+n);if(r){Array.isArray(r)||(r=[r]);for(var i=[],a=0;a<r.length;a++)i[a]=e.deserialize(o,r[a],n+"["+a+"]");return i}return r}(this,e,t,r):null!==o.match(/^Dictionary$/gi)&&(n=function(e,t,r,n){var o=t.type.value;if(!o||"object"!=typeof o)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+n);if(r){for(var i={},a=0,s=Object.keys(r);a<s.length;a++){var u=s[a];i[u]=e.deserialize(o,r[u],n)}return i}return r}(this,e,t,r))),e.isConstant&&(n=e.defaultValue),n},e}();function R(e){var t=[],r="";if(e)for(var n=0,o=e.split(".");n<o.length;n++){var i=o[n];"\\"===i.charAt(i.length-1)?r+=i.substr(0,i.length-1)+".":(r+=i,t.push(r),r="")}return t}function T(e,t,r){var n=t.type.modelProperties;if(!n){var o=t.type.className;if(!o)throw new Error('Class name for model "'+r+'" is not provided in the mapper "'+JSON.stringify(t,void 0,2)+'".');var i=e.modelMappers[o];if(!i)throw new Error('mapper() cannot be null or undefined for model "'+o+'".');if(!(n=i.type.modelProperties))throw new Error('modelProperties cannot be null or undefined in the mapper "'+JSON.stringify(i)+'" of type "'+o+'" for object "'+r+'".')}return n}function _(e){return["$","_"].includes(e)}function P(e,t,r,n){var o=S(e,t);if(o){var i=o[n];if(null!=i){var a=r[i];if(null!=a){var s=t.type.uberParent||t.type.className,u=a===s?a:s+"."+a,l=e.modelMappers.discriminators[u];l&&(t=l)}}}return t}function S(e,t){return t.type.polymorphicDiscriminator||O(e,t.type.uberParent)||O(e,t.type.className)}function O(e,t){return t&&e.modelMappers[t]&&e.modelMappers[t].type.polymorphicDiscriminator}var x=function(e){for(var t={},r=0,n=e;r<n.length;r++){var o=n[r];t[o]=o}return t}(["Base64Url","Boolean","ByteArray","Composite","Date","DateTime","DateTimeRfc1123","Dictionary","Enum","Number","Object","Sequence","String","Stream","TimeSpan","UnixTime"]);var N=function(){function e(e,t,o,i,a,s,u,l,c,f,p,h,d,y){this.streamResponseBody=s,this.url=e||"",this.method=t||"GET",this.headers=r(a)?a:new n(a),this.body=o,this.query=i,this.formData=void 0,this.withCredentials=u||!1,this.abortSignal=l,this.timeout=c||0,this.onUploadProgress=f,this.onDownloadProgress=p,this.proxySettings=h,this.keepAlive=d,this.agentSettings=y}return e.prototype.validateRequestProperties=function(){if(!this.method)throw new Error("WebResource.method is required.");if(!this.url)throw new Error("WebResource.url is required.")},e.prototype.prepare=function(e){if(!e)throw new Error("options object is required");if(null==e.method||"string"!=typeof e.method.valueOf())throw new Error("options.method must be a string.");if(e.url&&e.pathTemplate)throw new Error("options.url and options.pathTemplate are mutually exclusive. Please provide exactly one of them.");if(!(null!=e.pathTemplate&&"string"==typeof e.pathTemplate.valueOf()||null!=e.url&&"string"==typeof e.url.valueOf()))throw new Error("Please provide exactly one of options.pathTemplate or options.url.");if(e.url){if("string"!=typeof e.url)throw new Error('options.url must be of type "string".');this.url=e.url}if(e.method){var t=["GET","PUT","HEAD","DELETE","OPTIONS","POST","PATCH","TRACE"];if(-1===t.indexOf(e.method.toUpperCase()))throw new Error('The provided method "'+e.method+'" is invalid. Supported HTTP methods are: '+JSON.stringify(t))}if(this.method=e.method.toUpperCase(),e.pathTemplate){var r=e.pathTemplate,n=e.pathParameters;if("string"!=typeof r)throw new Error('options.pathTemplate must be of type "string".');e.baseUrl||(e.baseUrl="https://management.azure.com");var o=e.baseUrl,i=o+(o.endsWith("/")?"":"/")+(r.startsWith("/")?r.slice(1):r),a=i.match(/({\w*\s*\w*})/gi);if(a&&a.length){if(!n)throw new Error("pathTemplate: "+r+" has been provided. Hence, options.pathParameters must also be provided.");a.forEach((function(e){var t=e.slice(1,-1),o=n[t];if(null==o||"string"!=typeof o&&"object"!=typeof o)throw new Error("pathTemplate: "+r+" contains the path parameter "+t+" however, it is not present in "+n+" - "+JSON.stringify(n,void 0,2)+'.The value of the path parameter can either be a "string" of the form { '+t+': "some sample value" } or it can be an "object" of the form { "'+t+'": { value: "some sample value", skipUrlEncoding: true } }.');if("string"==typeof o.valueOf()&&(i=i.replace(e,encodeURIComponent(o))),"object"==typeof o.valueOf()){if(!o.value)throw new Error("options.pathParameters["+t+'] is of type "object" but it does not contain a "value" property.');i=o.skipUrlEncoding?i.replace(e,o.value):i.replace(e,encodeURIComponent(o.value))}}))}this.url=i}if(e.queryParameters){var s=e.queryParameters;if("object"!=typeof s)throw new Error('options.queryParameters must be of type object. It should be a JSON object of "query-parameter-name" as the key and the "query-parameter-value" as the value. The "query-parameter-value" may be fo type "string" or an "object" of the form { value: "query-parameter-value", skipUrlEncoding: true }.');this.url&&-1===this.url.indexOf("?")&&(this.url+="?");var u=[];for(var l in this.query={},s){var c=s[l];if(c)if("string"==typeof c)u.push(l+"="+encodeURIComponent(c)),this.query[l]=encodeURIComponent(c);else if("object"==typeof c){if(!c.value)throw new Error("options.queryParameters["+l+'] is of type "object" but it does not contain a "value" property.');c.skipUrlEncoding?(u.push(l+"="+c.value),this.query[l]=c.value):(u.push(l+"="+encodeURIComponent(c.value)),this.query[l]=encodeURIComponent(c.value))}}this.url+=u.join("&")}if(e.headers)for(var f=e.headers,p=0,h=Object.keys(e.headers);p<h.length;p++){var d=h[p];this.headers.set(d,f[d])}return this.headers.get("accept-language")||this.headers.set("accept-language","en-US"),this.headers.get("x-ms-client-request-id")||e.disableClientRequestId||this.headers.set("x-ms-client-request-id",m()),this.headers.get("Content-Type")||this.headers.set("Content-Type","application/json; charset=utf-8"),this.body=e.body,null!=e.body&&(e.bodyIsStream?(this.headers.get("Transfer-Encoding")||this.headers.set("Transfer-Encoding","chunked"),"application/octet-stream"!==this.headers.get("Content-Type")&&this.headers.set("Content-Type","application/octet-stream")):(e.serializationMapper&&(this.body=new E(e.mappers).serialize(e.serializationMapper,e.body,"requestBody")),e.disableJsonStringifyOnBody||(this.body=JSON.stringify(e.body)))),this.abortSignal=e.abortSignal,this.onDownloadProgress=e.onDownloadProgress,this.onUploadProgress=e.onUploadProgress,this},e.prototype.clone=function(){var t=new e(this.url,this.method,this.body,this.query,this.headers&&this.headers.clone(),this.streamResponseBody,this.withCredentials,this.abortSignal,this.timeout,this.onUploadProgress,this.onDownloadProgress,this.proxySettings,this.keepAlive,this.agentSettings);return this.formData&&(t.formData=this.formData),this.operationSpec&&(t.operationSpec=this.operationSpec),this.shouldDeserialize&&(t.shouldDeserialize=this.shouldDeserialize),this.operationResponseGetter&&(t.operationResponseGetter=this.operationResponseGetter),t},e}(),A=function(e,t){return(A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function q(e,t){function r(){this.constructor=e}A(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var C=function(){return(C=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function D(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))}function I(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var U,H=function(e){function t(r,n,o,i,a,s){var u=e.call(this,r)||this;return u.code=n,u.statusCode=o,u.request=i,u.response=a,u.body=s,Object.setPrototypeOf(u,t.prototype),u}return q(t,e),t.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",t.REQUEST_ABORTED_ERROR="REQUEST_ABORTED_ERROR",t.PARSE_ERROR="PARSE_ERROR",t}(Error),M=function(){function e(){}return e.prototype.sendRequest=function(e){var t=new XMLHttpRequest;if(e.agentSettings)throw new Error("HTTP agent settings not supported in browser environment");if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");var r=e.abortSignal;if(r){var n=function(){t.abort()};r.addEventListener("abort",n),t.addEventListener("readystatechange",(function(){t.readyState===XMLHttpRequest.DONE&&r.removeEventListener("abort",n)}))}if(j(t.upload,e.onUploadProgress),j(t,e.onDownloadProgress),e.formData){for(var o=e.formData,i=new FormData,a=function(e,t){t&&t.hasOwnProperty("value")&&t.hasOwnProperty("options")?i.append(e,t.value,t.options):i.append(e,t)},s=0,u=Object.keys(o);s<u.length;s++){var l=u[s],c=o[l];if(Array.isArray(c))for(var f=0;f<c.length;f++)a(l,c[f]);else a(l,c)}e.body=i,e.formData=void 0;var p=e.headers.get("Content-Type");p&&-1!==p.indexOf("multipart/form-data")&&e.headers.remove("Content-Type")}t.open(e.method,e.url),t.timeout=e.timeout,t.withCredentials=e.withCredentials;for(var h=0,d=e.headers.headersArray();h<d.length;h++){var y=d[h];t.setRequestHeader(y.name,y.value)}return t.responseType=e.streamResponseBody?"blob":"text",t.send(void 0===e.body?null:e.body),e.streamResponseBody?new Promise((function(r,n){t.addEventListener("readystatechange",(function(){if(t.readyState===XMLHttpRequest.HEADERS_RECEIVED){var n=new Promise((function(r,n){t.addEventListener("load",(function(){r(t.response)})),k(e,t,n)}));r({request:e,status:t.status,headers:z(t),blobBody:n})}})),k(e,t,n)})):new Promise((function(r,n){t.addEventListener("load",(function(){return r({request:e,status:t.status,headers:z(t),bodyAsText:t.responseText})})),k(e,t,n)}))},e}();function j(e,t){t&&e.addEventListener("progress",(function(e){return t({loadedBytes:e.loaded})}))}function z(e){for(var t=new n,r=0,o=e.getAllResponseHeaders().trim().split(/[\r\n]+/);r<o.length;r++){var i=o[r],a=i.indexOf(":"),s=i.slice(0,a),u=i.slice(a+2);t.set(s,u)}return t}function k(e,t,r){t.addEventListener("error",(function(){return r(new H("Failed to send request to "+e.url,H.REQUEST_SEND_ERROR,void 0,e))})),t.addEventListener("abort",(function(){return r(new H("The request was aborted",H.REQUEST_ABORTED_ERROR,void 0,e))})),t.addEventListener("timeout",(function(){return r(new H("timeout of "+t.timeout+"ms exceeded",H.REQUEST_SEND_ERROR,void 0,e))}))}function L(e){return B(e.parameterPath,e.mapper)}function B(e,t){return"string"==typeof e?e:Array.isArray(e)?e.join("."):t.serializedName}function F(e){var t=!1;for(var r in e.responses){var n=e.responses[r];if(n.bodyMapper&&n.bodyMapper.type.name===x.Stream){t=!0;break}}return t}(U=e.HttpPipelineLogLevel||(e.HttpPipelineLogLevel={}))[U.OFF=0]="OFF",U[U.ERROR=1]="ERROR",U[U.WARNING=2]="WARNING",U[U.INFO=3]="INFO";var Q=new DOMParser;function $(e){try{var t=Q.parseFromString(e,"application/xml");!function(e){if(V){var t=e.getElementsByTagNameNS(V,"parsererror");if(t.length)throw new Error(t.item(0).innerHTML)}}(t);var r=function e(t){var r={},n=t.childNodes.length,o=t.childNodes[0],i=o&&1===n&&o.nodeType===Node.TEXT_NODE&&o.nodeValue||void 0,a=function(e){return function(e){return!!e.attributes}(e)&&e.hasAttributes()?e:void 0}(t);if(a){r.$={};for(var s=0;s<a.attributes.length;s++){var u=a.attributes[s];r.$[u.nodeName]=u.nodeValue}i&&(r._=i)}else 0===n?r="":i&&(r=i);if(!i)for(s=0;s<n;s++){var l=t.childNodes[s];if(l.nodeType!==Node.TEXT_NODE){var c=e(l);r[l.nodeName]?Array.isArray(r[l.nodeName])?r[l.nodeName].push(c):r[l.nodeName]=[r[l.nodeName],c]:r[l.nodeName]=c}}return r}(t.childNodes[0]);return Promise.resolve(r)}catch(e){return Promise.reject(e)}}var V="";try{V=Q.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI}catch(e){}var Y=document.implementation.createDocument(null,null,null),X=new XMLSerializer;function J(e,t){var r=function e(t,r){if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return(c=Y.createElement(r)).textContent=t.toString(),[c];if(Array.isArray(t)){for(var n=[],o=0,i=t;o<i.length;o++)for(var a=i[o],s=0,u=e(a,r);s<u.length;s++){var l=u[s];n.push(l)}return n}if("object"==typeof t){for(var c=Y.createElement(r),f=0,p=Object.keys(t);f<p.length;f++){var h=p[f];if("$"===h)for(var d=0,y=W(t[h]);d<y.length;d++){var m=y[d];c.attributes.setNamedItem(m)}else for(var v=0,g=e(t[h],h);v<g.length;v++){l=g[v];c.appendChild(l)}}return[c]}throw new Error("Illegal value passed to buildObject: "+t)}(e,t&&t.rootName||"root")[0];return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+X.serializeToString(r)}function W(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var o=n[r],i=Y.createAttribute(o);i.value=e[o].toString(),t.push(i)}return t}var G=function(){function e(e,t){this._nextPolicy=e,this._options=t}return e.prototype.shouldLog=function(e){return this._options.shouldLog(e)},e.prototype.log=function(e,t){this._options.log(e,t)},e}(),K=function(){function t(e){this._logger=e}return t.prototype.shouldLog=function(t){return!!this._logger&&t!==e.HttpPipelineLogLevel.OFF&&t<=this._logger.minimumLogLevel},t.prototype.log=function(e,t){this._logger&&this.shouldLog(e)&&this._logger.log(e,t)},t}();function Z(e){return{create:function(t,r){return new re(t,e,r)}}}var ee=["application/json","text/json"],te=["application/xml","application/atom+xml"],re=function(e){function t(t,r,n){var o=e.call(this,t,n)||this;return o.jsonContentTypes=r&&r.json||ee,o.xmlContentTypes=r&&r.xml||te,o}return q(t,e),t.prototype.sendRequest=function(e){return D(this,void 0,void 0,(function(){var t=this;return I(this,(function(r){return[2,this._nextPolicy.sendRequest(e).then((function(e){return ne(t.jsonContentTypes,t.xmlContentTypes,e)}))]}))}))},t}(G);function ne(e,t,r){return function(e,t,r){var n=function(e){var t='Error "'+e+'" occurred while parsing the response body - '+r.bodyAsText+".",n=e.code||H.PARSE_ERROR,o=new H(t,n,r.status,r.request,r,r.bodyAsText);return Promise.reject(o)};if(!r.request.streamResponseBody&&r.bodyAsText){var o=r.bodyAsText,i=r.headers.get("Content-Type")||"",a=i?i.split(";").map((function(e){return e.toLowerCase()})):[];if(0===a.length||a.some((function(t){return-1!==e.indexOf(t)})))return new Promise((function(e){r.parsedBody=JSON.parse(o),e(r)})).catch(n);if(a.some((function(e){return-1!==t.indexOf(e)})))return $(o).then((function(e){return r.parsedBody=e,r})).catch(n)}return Promise.resolve(r)}(e,t,r).then((function(e){if(function(e){var t=e.request.shouldDeserialize;return void 0===t||("boolean"==typeof t?t:t(e))}(e)){var t=e.request.operationSpec;if(t&&t.responses){var n=e.status,o=Object.keys(t.responses),i=0===o.length||1===o.length&&"default"===o[0],a=function(e){var t,r=e.request,n=r.operationSpec;if(n){var o=r.operationResponseGetter;t=o?o(n,e):n.responses[e.status]}return t}(e);if(i?200<=n&&n<300:!!a){if(a){if(a.bodyMapper){m=e.parsedBody;t.isXML&&a.bodyMapper.type.name===x.Sequence&&(m="object"==typeof m?m[a.bodyMapper.xmlElementName]:[]);try{e.parsedBody=t.serializer.deserialize(a.bodyMapper,m,"operationRes.parsedBody")}catch(c){var s=new H("Error "+c+" occurred in deserializing the responseBody - "+e.bodyAsText);return s.request=d(e.request),s.response=h(e),Promise.reject(s)}}else"HEAD"===t.httpMethod&&(e.parsedBody=r.status>=200&&r.status<300);a.headersMapper&&(e.parsedHeaders=t.serializer.deserialize(a.headersMapper,e.headers.rawHeaders(),"operationRes.parsedHeaders"))}}else{var u=t.responses.default;if(u){var l=F(t)?"Unexpected status code: "+n:e.bodyAsText,c=new H(l);c.statusCode=n,c.request=d(e.request),c.response=h(e);var f=e.parsedBody;try{if(f){var p=u.bodyMapper;if(p&&"CloudError"===p.serializedName)f.error&&(f=f.error),f.code&&(c.code=f.code),f.message&&(c.message=f.message);else{var y=f;f.error&&(y=f.error),c.code=y.code,y.message&&(c.message=y.message)}if(p){var m=f;t.isXML&&p.type.name===x.Sequence&&(m="object"==typeof f?f[p.xmlElementName]:[]),c.body=t.serializer.deserialize(p,m,"error.body")}}}catch(t){c.message='Error "'+t.message+'" occurred in deserializing the responseBody - "'+e.bodyAsText+'" for the default response.'}return Promise.reject(c)}}}}return Promise.resolve(e)}))}function oe(e,t,r,n){return{create:function(o,i){return new ie(o,i,e,t,r,n)}}}var ie=function(e){function t(t,r,n,o,i,a){var s=e.call(this,t,r)||this;function u(e){return"number"==typeof e}return s.retryCount=u(n)?n:3,s.retryInterval=u(o)?o:3e4,s.minRetryInterval=u(i)?i:3e3,s.maxRetryInterval=u(a)?a:9e4,s}return q(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then((function(r){return ae(t,e,r)})).catch((function(r){return ae(t,e,r.response,void 0,r)}))},t}(G);function ae(e,t,r,n,o){n=function(e,t,r){t||(t={retryCount:0,retryInterval:0}),r&&(t.error&&(r.innerError=t.error),t.error=r),t.retryCount++;var n=Math.pow(2,t.retryCount)-1;return n*=.8*e.retryInterval+Math.floor(Math.random()*(1.2*e.retryInterval-.8*e.retryInterval)),t.retryInterval=Math.min(e.minRetryInterval+n,e.maxRetryInterval),t}(e,n,o);var i=t.abortSignal&&t.abortSignal.aborted;if(!i&&function(e,t,r){if(null==t||t<500&&408!==t||501===t||505===t)return!1;if(!r)throw new Error("retryData for the ExponentialRetryPolicyFilter cannot be null.");return(r&&r.retryCount)<e.retryCount}(e,r&&r.status,n))return v(n.retryInterval).then((function(){return e._nextPolicy.sendRequest(t.clone())})).then((function(r){return ae(e,t,r,n,void 0)})).catch((function(o){return ae(e,t,r,n,o)}));if(i||o||!r){var a=n.error||new H("Failed to send the request.",H.REQUEST_SEND_ERROR,r&&r.status,r&&r.request,r);return Promise.reject(a)}return Promise.resolve(r)}function se(e){return void 0===e&&(e="x-ms-client-request-id"),{create:function(t,r){return new ue(t,r,e)}}}var ue=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o._requestIdHeaderName=n,o}return q(t,e),t.prototype.sendRequest=function(e){return e.headers.contains(this._requestIdHeaderName)||e.headers.set(this._requestIdHeaderName,m()),this._nextPolicy.sendRequest(e)},t}(G);function le(){return"x-ms-command-name"}var ce=le;function fe(){var e,t,r,n,o=[{key:"ms-rest-js",value:f.msRestVersion}],i=[{key:"OS",value:((e=window.navigator).oscpu||e.platform).replace(" ","")}];return t=o.concat(i),void 0===r&&(r=" "),void 0===n&&(n="/"),t.map((function(e){var t=e.value?""+n+e.value:"";return""+e.key+t})).join(r)}function pe(e){var t=e&&null!=e.key?e.key:"x-ms-command-name",r=e&&null!=e.value?e.value:fe();return{create:function(e,n){return new he(e,n,t,r)}}}var he=function(e){function t(t,r,n,o){var i=e.call(this,t,r)||this;return i._nextPolicy=t,i._options=r,i.headerKey=n,i.headerValue=o,i}return q(t,e),t.prototype.sendRequest=function(e){return this.addUserAgentHeader(e),this._nextPolicy.sendRequest(e)},t.prototype.addUserAgentHeader=function(e){e.headers||(e.headers=new n),!e.headers.get(this.headerKey)&&this.headerValue&&e.headers.set(this.headerKey,this.headerValue)},t}(G),de=function(){function e(){this._rawQuery={}}return e.prototype.any=function(){return Object.keys(this._rawQuery).length>0},e.prototype.set=function(e,t){if(e)if(null!=t){var r=Array.isArray(t)?t:t.toString();this._rawQuery[e]=r}else delete this._rawQuery[e]},e.prototype.get=function(e){return e?this._rawQuery[e]:void 0},e.prototype.toString=function(){var e="";for(var t in this._rawQuery){e&&(e+="&");var r=this._rawQuery[t];if(Array.isArray(r)){for(var n=[],o=0,i=r;o<i.length;o++){var a=i[o];n.push(t+"="+a)}e+=n.join("&")}else e+=t+"="+r}return e},e.parse=function(t){var r=new e;if(t){t.startsWith("?")&&(t=t.substring(1));for(var n="ParameterName",o="",i="",a=0;a<t.length;++a){var s=t[a];switch(n){case"ParameterName":switch(s){case"=":n="ParameterValue";break;case"&":o="",i="";break;default:o+=s}break;case"ParameterValue":switch(s){case"=":o="",i="",n="Invalid";break;case"&":r.set(o,i),o="",i="",n="ParameterName";break;default:i+=s}break;case"Invalid":"&"===s&&(n="ParameterName");break;default:throw new Error("Unrecognized URLQuery parse state: "+n)}}"ParameterValue"===n&&r.set(o,i)}return r},e}(),ye=function(){function e(){}return e.prototype.setScheme=function(e){e?this.set(e,"SCHEME"):this._scheme=void 0},e.prototype.getScheme=function(){return this._scheme},e.prototype.setHost=function(e){e?this.set(e,"SCHEME_OR_HOST"):this._host=void 0},e.prototype.getHost=function(){return this._host},e.prototype.setPort=function(e){null==e||""===e?this._port=void 0:this.set(e.toString(),"PORT")},e.prototype.getPort=function(){return this._port},e.prototype.setPath=function(e){e?-1!==e.indexOf("://")?this.set(e,"SCHEME"):this.set(e,"PATH"):this._path=void 0},e.prototype.appendPath=function(e){if(e){var t=this.getPath();t&&(t.endsWith("/")||(t+="/"),e.startsWith("/")&&(e=e.substring(1)),e=t+e),this.set(e,"PATH")}},e.prototype.getPath=function(){return this._path},e.prototype.setQuery=function(e){this._query=e?de.parse(e):void 0},e.prototype.setQueryParameter=function(e,t){e&&(this._query||(this._query=new de),this._query.set(e,t))},e.prototype.getQueryParameterValue=function(e){return this._query?this._query.get(e):void 0},e.prototype.getQuery=function(){return this._query?this._query.toString():void 0},e.prototype.set=function(e,t){for(var r=new ve(e,t);r.next();){var n=r.current();if(n)switch(n.type){case"SCHEME":this._scheme=n.text||void 0;break;case"HOST":this._host=n.text||void 0;break;case"PORT":this._port=n.text||void 0;break;case"PATH":var o=n.text||void 0;this._path&&"/"!==this._path&&"/"===o||(this._path=o);break;case"QUERY":this._query=de.parse(n.text);break;default:throw new Error("Unrecognized URLTokenType: "+n.type)}}},e.prototype.toString=function(){var e="";return this._scheme&&(e+=this._scheme+"://"),this._host&&(e+=this._host),this._port&&(e+=":"+this._port),this._path&&(this._path.startsWith("/")||(e+="/"),e+=this._path),this._query&&this._query.any()&&(e+="?"+this._query.toString()),e},e.prototype.replaceAll=function(e,t){e&&(this.setScheme(w(this.getScheme(),e,t)),this.setHost(w(this.getHost(),e,t)),this.setPort(w(this.getPort(),e,t)),this.setPath(w(this.getPath(),e,t)),this.setQuery(w(this.getQuery(),e,t)))},e.parse=function(t){var r=new e;return r.set(t,"SCHEME_OR_HOST"),r},e}(),me=function(){function e(e,t){this.text=e,this.type=t}return e.scheme=function(t){return new e(t,"SCHEME")},e.host=function(t){return new e(t,"HOST")},e.port=function(t){return new e(t,"PORT")},e.path=function(t){return new e(t,"PATH")},e.query=function(t){return new e(t,"QUERY")},e}();var ve=function(){function e(e,t){this._text=e,this._textLength=e?e.length:0,this._currentState=null!=t?t:"SCHEME_OR_HOST",this._currentIndex=0}return e.prototype.current=function(){return this._currentToken},e.prototype.next=function(){if(ge(this))switch(this._currentState){case"SCHEME":t=function(e){return Re(e,(function(e){return function(e){var t=e.charCodeAt(0);return 48<=t&&t<=57||65<=t&&t<=90||97<=t&&t<=122}(e)}))}(e=this),e._currentToken=me.scheme(t),ge(e)?e._currentState="HOST":e._currentState="DONE";break;case"SCHEME_OR_HOST":!function(e){var t=Te(e,":","/","?");ge(e)?":"===be(e)?"://"===Ee(e,3)?(e._currentToken=me.scheme(t),e._currentState="HOST"):(e._currentToken=me.host(t),e._currentState="PORT"):(e._currentToken=me.host(t),"/"===be(e)?e._currentState="PATH":e._currentState="QUERY"):(e._currentToken=me.host(t),e._currentState="DONE")}(this);break;case"HOST":!function(e){"://"===Ee(e,3)&&we(e,3);var t=Te(e,":","/","?");e._currentToken=me.host(t),ge(e)?":"===be(e)?e._currentState="PORT":"/"===be(e)?e._currentState="PATH":e._currentState="QUERY":e._currentState="DONE"}(this);break;case"PORT":!function(e){":"===be(e)&&we(e);var t=Te(e,"/","?");e._currentToken=me.port(t),ge(e)?"/"===be(e)?e._currentState="PATH":e._currentState="QUERY":e._currentState="DONE"}(this);break;case"PATH":!function(e){var t=Te(e,"?");e._currentToken=me.path(t),ge(e)?e._currentState="QUERY":e._currentState="DONE"}(this);break;case"QUERY":!function(e){"?"===be(e)&&we(e);var t=function(e){var t="";e._currentIndex<e._textLength&&(t=e._text.substring(e._currentIndex),e._currentIndex=e._textLength);return t}(e);e._currentToken=me.query(t),e._currentState="DONE"}(this);break;default:throw new Error("Unrecognized URLTokenizerState: "+this._currentState)}else this._currentToken=void 0;var e,t;return!!this._currentToken},e}();function ge(e){return e._currentIndex<e._textLength}function be(e){return e._text[e._currentIndex]}function we(e,t){ge(e)&&(t||(t=1),e._currentIndex+=t)}function Ee(e,t){var r=e._currentIndex+t;return e._textLength<r&&(r=e._textLength),e._text.substring(e._currentIndex,r)}function Re(e,t){for(var r="";ge(e);){var n=be(e);if(!t(n))break;r+=n,we(e)}return r}function Te(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return Re(e,(function(e){return-1===t.indexOf(e)}))}function _e(e){return void 0===e&&(e=20),{create:function(t,r){return new Pe(t,r,e)}}}var Pe=function(e){function t(t,r,n){void 0===n&&(n=20);var o=e.call(this,t,r)||this;return o.maxRetries=n,o}return q(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e).then((function(e){return function e(t,r,n){var o=r.request,i=r.status,a=r.headers.get("location");if(a&&(300===i||307===i||303===i&&"POST"===o.method)&&(!t.maxRetries||n<t.maxRetries)){var s=ye.parse(o.url);return s.setPath(a),o.url=s.toString(),303===i&&(o.method="GET"),t._nextPolicy.sendRequest(o).then((function(r){return e(t,r,n+1)}))}return Promise.resolve(r)}(t,e,0)}))},t}(G);var Se=function(e){function t(t,r,n){void 0===n&&(n=30);var o=e.call(this,t,r)||this;return o._retryTimeout=n,o}return q(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then((function(r){return function(e,t,r){if(409===r.status){var n=function(e){var t,r;if(e){try{r=JSON.parse(e)}catch(e){}if(r&&r.error&&r.error.message&&r.error.code&&"MissingSubscriptionRegistration"===r.error.code){var n=r.error.message.match(/.*'(.*)'/i);n&&(t=n.pop())}}return t}(r.bodyAsText);if(n){var o=function(e){var t,r=e.match(/.*\/subscriptions\/[a-f0-9-]+\//gi);if(!r||!r[0])throw new Error("Unable to extract subscriptionId from the given url - "+e+".");t=r[0];return t}(t.url);return function(e,t,r,n){var o=t+"providers/"+r+"/register?api-version=2016-02-01",i=t+"providers/"+r+"?api-version=2016-02-01",a=Oe(n);return a.method="POST",a.url=o,e._nextPolicy.sendRequest(a).then((function(t){if(200!==t.status)throw new Error("Autoregistration of "+r+" failed. Please try registering manually.");return function e(t,r,n){var o=Oe(n);return o.url=r,o.method="GET",t._nextPolicy.sendRequest(o).then((function(o){var i=o.parsedBody;return!(!o.parsedBody||!i.registrationState||"Registered"!==i.registrationState)||v(1e3*t._retryTimeout).then((function(){return e(t,r,n)}))}))}(e,i,n)}))}(e,o,n,t).catch((function(){return!1})).then((function(n){return n?(t.headers.set("x-ms-client-request-id",m()),e._nextPolicy.sendRequest(t.clone())):r}))}}return Promise.resolve(r)}(t,e,r)}))},t}(G);function Oe(e,t){void 0===t&&(t=!1);var r=e.clone();return t&&(r.url=e.url),r.headers.set("x-ms-client-request-id",m()),r.headers.set("Content-Type","application/json; charset=utf-8"),r}function xe(e){return{create:function(t,r){return new Ne(t,r,e)}}}var Ne=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o.authenticationProvider=n,o}return q(t,e),t.prototype.signRequest=function(e){return this.authenticationProvider.signRequest(e)},t.prototype.sendRequest=function(e){var t=this;return this.signRequest(e).then((function(e){return t._nextPolicy.sendRequest(e)}))},t}(G);function Ae(e,t,r,n){return{create:function(o,i){return new Ce(o,i,e,t,r,n)}}}var qe,Ce=function(e){function t(t,r,n,o,i,a){var s=e.call(this,t,r)||this;return s.DEFAULT_CLIENT_RETRY_INTERVAL=3e4,s.DEFAULT_CLIENT_RETRY_COUNT=3,s.DEFAULT_CLIENT_MAX_RETRY_INTERVAL=9e4,s.DEFAULT_CLIENT_MIN_RETRY_INTERVAL=3e3,s.retryCount="number"==typeof n?n:s.DEFAULT_CLIENT_RETRY_COUNT,s.retryInterval="number"==typeof o?o:s.DEFAULT_CLIENT_RETRY_INTERVAL,s.minRetryInterval="number"==typeof i?i:s.DEFAULT_CLIENT_MIN_RETRY_INTERVAL,s.maxRetryInterval="number"==typeof a?a:s.DEFAULT_CLIENT_MAX_RETRY_INTERVAL,s}return q(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then((function(r){return function e(t,r,n,o,i){return o=function(e,t,r){t||(t={retryCount:0,retryInterval:0});r&&(t.error&&(r.innerError=t.error),t.error=r);t.retryCount++;var n=Math.pow(2,t.retryCount)-1,o=.8*e.retryInterval+Math.floor(Math.random()*(1.2*e.retryInterval-.8*e.retryInterval));return n*=o,t.retryInterval=Math.min(e.minRetryInterval+n,e.maxRetryInterval),t}(t,o,i),i&&i.code&&function(e,t){var r;if(!t)throw new Error("retryData for the SystemErrorRetryPolicyFilter cannot be null.");r=t&&t.retryCount;return r<e.retryCount}(t,o)&&("ETIMEDOUT"===i.code||"ESOCKETTIMEDOUT"===i.code||"ECONNREFUSED"===i.code||"ECONNRESET"===i.code||"ENOENT"===i.code)?v(o.retryInterval).then((function(){return t._nextPolicy.sendRequest(r.clone())})).then((function(n){return e(t,r,n,o,i)})).catch((function(i){return e(t,r,n,o,i)})):null!=i?(i=o.error,Promise.reject(i)):Promise.resolve(n)}(t,e,r)}))},t}(G);(qe=e.QueryCollectionFormat||(e.QueryCollectionFormat={})).Csv=",",qe.Ssv=" ",qe.Tsv="\t",qe.Pipes="|",qe.Multi="Multi";var De=new Error("AgentPolicy is not supported in browser environment");function Ie(e){return{create:function(e,t){throw De}}}!function(e){function t(t,r){e.call(this,t,r);throw De}q(t,e),t.prototype.sendRequest=function(e){throw De}}(G);var Ue=new Error("ProxyPolicy is not supported in browser environment");function He(e){}function Me(e){return{create:function(e,t){throw Ue}}}!function(e){function t(t,r){e.call(this,t,r);throw Ue}q(t,e),t.prototype.sendRequest=function(e){throw Ue}}(G);var je=f.HttpConstants.StatusCodes;function ze(){return{create:function(e,t){return new ke(e,t)}}}var ke=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o._handleResponse=n||o._defaultResponseHandler,o}return q(t,e),t.prototype.sendRequest=function(e){return D(this,void 0,void 0,(function(){var t=this;return I(this,(function(r){return[2,this._nextPolicy.sendRequest(e.clone()).then((function(r){return r.status!==je.TooManyRequests?r:t._handleResponse(e,r)}))]}))}))},t.prototype._defaultResponseHandler=function(e,r){return D(this,void 0,void 0,(function(){var n,o,i=this;return I(this,(function(a){return(n=r.headers.get(f.HeaderConstants.RETRY_AFTER))&&(o=t.parseRetryAfterHeader(n))?[2,v(o).then((function(t){return i._nextPolicy.sendRequest(e)}))]:[2,r]}))}))},t.parseRetryAfterHeader=function(e){var r=Number(e);return Number.isNaN(r)?t.parseDateRetryAfterHeader(e):1e3*r},t.parseDateRetryAfterHeader=function(e){try{var t=Date.now(),r=Date.parse(e)-t;return Number.isNaN(r)?void 0:r}catch(e){return}},t}(G),Le=function(){function t(e,t){if(t||(t={}),e&&!e.signRequest)throw new Error("credentials argument needs to implement signRequest method");var r;if(this._withCredentials=t.withCredentials||!1,this._httpClient=t.httpClient||new M,this._requestPolicyOptions=new K(t.httpPipelineLogger),Array.isArray(t.requestPolicyFactories))r=t.requestPolicyFactories;else if(r=function(e,t){var r=[];t.generateClientRequestIdHeader&&r.push(se(t.clientRequestIdHeaderName));e&&("function"==typeof e.create?r.push(e):r.push(xe(e)));var n=Be(t.userAgentHeaderName,ce),o=Be(t.userAgent,fe);n&&o&&r.push(pe({key:n,value:o}));r.push(_e()),r.push(function(e){return void 0===e&&(e=30),{create:function(t,r){return new Se(t,r,e)}}}(t.rpRegistrationRetryTimeout)),t.noRetryPolicy||(r.push(oe()),r.push(Ae()),r.push(ze()));r.push(Z(t.deserializationContentTypes)),t.proxySettings?r.push(Me()):void 0;t.agentSettings&&r.push(Ie(t.agentSettings));return r}(e,t),t.requestPolicyFactories){var n=t.requestPolicyFactories(r);n&&(r=n)}this._requestPolicyFactories=r}return t.prototype.sendRequest=function(e){if(null==e||"object"!=typeof e)throw new Error("options cannot be null or undefined and it must be of type object.");var t,n;try{"object"==typeof(n=e)&&"string"==typeof n.url&&"string"==typeof n.method&&"object"==typeof n.headers&&r(n.headers)&&"function"==typeof n.validateRequestProperties&&"function"==typeof n.prepare&&"function"==typeof n.clone?(e.validateRequestProperties(),t=e):t=(t=new N).prepare(e)}catch(e){return Promise.reject(e)}var o=this._httpClient;if(this._requestPolicyFactories&&this._requestPolicyFactories.length>0)for(var i=this._requestPolicyFactories.length-1;i>=0;--i)o=this._requestPolicyFactories[i].create(o,this._requestPolicyOptions);return o.sendRequest(t)},t.prototype.sendOperationRequest=function(t,r,n){"function"==typeof t.options&&(n=t.options,t.options=void 0);var o,i=new N;try{var a=r.baseUrl||this.baseUri;if(!a)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a baseUri string property that contains the base URL to use.");i.method=r.httpMethod,i.operationSpec=r;var s=ye.parse(a);if(r.path&&s.appendPath(r.path),r.urlParameters&&r.urlParameters.length>0)for(var u=0,l=r.urlParameters;u<l.length;u++){var c=l[u],f=Fe(this,t,c,r.serializer);f=r.serializer.serialize(c.mapper,f,L(c)),c.skipEncoding||(f=encodeURIComponent(f)),s.replaceAll("{"+(c.mapper.serializedName||L(c))+"}",f)}if(r.queryParameters&&r.queryParameters.length>0)for(var p=0,h=r.queryParameters;p<h.length;p++){var d=h[p],y=Fe(this,t,d,r.serializer);if(null!=y){if(y=r.serializer.serialize(d.mapper,y,L(d)),null!=d.collectionFormat)if(d.collectionFormat===e.QueryCollectionFormat.Multi)if(0===y.length)y="";else for(var m in y){var v=y[m];y[m]=null==v?"":v.toString()}else d.collectionFormat!==e.QueryCollectionFormat.Ssv&&d.collectionFormat!==e.QueryCollectionFormat.Tsv||(y=y.join(d.collectionFormat));if(!d.skipEncoding)if(Array.isArray(y))for(var m in y)void 0!==y[m]&&null!==y[m]&&(y[m]=encodeURIComponent(y[m]));else y=encodeURIComponent(y);null!=d.collectionFormat&&d.collectionFormat!==e.QueryCollectionFormat.Multi&&d.collectionFormat!==e.QueryCollectionFormat.Ssv&&d.collectionFormat!==e.QueryCollectionFormat.Tsv&&(y=y.join(d.collectionFormat)),s.setQueryParameter(d.mapper.serializedName||L(d),y)}}i.url=s.toString();var g=r.contentType||this.requestContentType;if(g&&i.headers.set("Content-Type",g),r.headerParameters)for(var b=0,w=r.headerParameters;b<w.length;b++){var E=w[b],R=Fe(this,t,E,r.serializer);if(null!=R){R=r.serializer.serialize(E.mapper,R,L(E));var T=E.mapper.headerCollectionPrefix;if(T)for(var _=0,P=Object.keys(R);_<P.length;_++){var S=P[_];i.headers.set(T+S,R[S])}else i.headers.set(E.mapper.serializedName||L(E),R)}}var O=t.options;if(O){if(O.customHeaders)for(var A in O.customHeaders)i.headers.set(A,O.customHeaders[A]);O.abortSignal&&(i.abortSignal=O.abortSignal),O.timeout&&(i.timeout=O.timeout),O.onUploadProgress&&(i.onUploadProgress=O.onUploadProgress),O.onDownloadProgress&&(i.onDownloadProgress=O.onDownloadProgress)}i.withCredentials=this._withCredentials,function(e,t,r,n){if(n.requestBody&&n.requestBody.mapper){t.body=Fe(e,r,n.requestBody,n.serializer);var o=n.requestBody.mapper,i=o.required,a=o.xmlName,s=o.xmlElementName,u=o.serializedName,l=o.type.name;try{if(null!=t.body||i){var c=L(n.requestBody);t.body=n.serializer.serialize(o,t.body,c);var f=l===x.Stream;n.isXML?l===x.Sequence?t.body=J(function(e,t){var r;return Array.isArray(e)||(e=[e]),(r={})[t]=e,r}(t.body,s||a||u),{rootName:a||u}):f||(t.body=J(t.body,{rootName:a||u})):f||(t.body=JSON.stringify(t.body))}}catch(e){throw new Error('Error "'+e.message+'" occurred in serializing the payload - '+JSON.stringify(u,void 0,"  ")+".")}}else if(n.formDataParameters&&n.formDataParameters.length>0){t.formData={};for(var p=0,h=n.formDataParameters;p<h.length;p++){var d=h[p],y=Fe(e,r,d,n.serializer);if(null!=y){var m=d.mapper.serializedName||L(d);t.formData[m]=n.serializer.serialize(d.mapper,y,L(d))}}}}(this,i,t,r),null==i.streamResponseBody&&(i.streamResponseBody=F(r)),o=this.sendRequest(i).then((function(e){return $e(e,r.responses[e.status])}))}catch(e){o=Promise.reject(e)}var q=n;return q&&o.then((function(e){return q(null,e._response.parsedBody,e._response.request,e._response)})).catch((function(e){return q(e)})),o},t}();function Be(e,t){var r;return"string"==typeof e?r=e:(r=t(),"function"==typeof e&&(r=e(r))),r}function Fe(e,t,r,n){return function e(t,r,n,o,i){var a;"string"==typeof n&&(n=[n]);if(Array.isArray(n)){if(n.length>0){if(o.isConstant)a=o.defaultValue;else{var s=Qe(r,n);s.propertyFound||(s=Qe(t,n));var u=!1;s.propertyFound||(u=o.required||"options"===n[0]&&2===n.length),a=u?o.defaultValue:s.propertyValue}var l=B(n,o);i.serialize(o,a,l)}}else for(var c in o.required&&(a={}),n){var f=o.type.modelProperties[c],p=n[c],h=e(t,r,p,f,i),d=B(p,f);i.serialize(f,h,d),void 0!==h&&(a||(a={}),a[c]=h)}return a}(e,t,r.parameterPath,r.mapper,n)}function Qe(e,t){for(var r={propertyFound:!1},n=0;n<t.length;++n){var o=t[n];if(null==e||!(o in e))break;e=e[o]}return n===t.length&&(r.propertyValue=e,r.propertyFound=!0),r}function $e(e,t){var r,n=e.parsedHeaders,o=t&&t.bodyMapper,i=function(t){return Object.defineProperty(t,"_response",{value:e})};if(o){var a=o.type.name;if("Stream"===a)return i(C(C({},n),{blobBody:e.blobBody,readableStreamBody:e.readableStreamBody}));var s="Composite"===a&&o.type.modelProperties||{},u=Object.keys(s).some((function(e){return""===s[e].serializedName}));if("Sequence"===a||u){for(var l=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}(Array.isArray(e.parsedBody)?e.parsedBody:[]),c=0,f=Object.keys(s);c<f.length;c++){var p=f[c];s[p].serializedName&&(l[p]=e.parsedBody[p])}if(n)for(var h=0,d=Object.keys(n);h<d.length;h++){l[p=d[h]]=n[p]}return i(l),l}if("Composite"===a||"Dictionary"===a)return i(C(C({},n),e.parsedBody))}return o||"HEAD"===e.request.method||("object"!=typeof(r=e.parsedBody)&&"function"!=typeof r||null===r)?i(C(C({},n),{body:e.parsedBody})):i(C(C({},n),e.parsedBody))}var Ve=function(e){function t(t,r,n){void 0===n&&(n=console.log);var o=e.call(this,t,r)||this;return o.logger=n,o}return q(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e).then((function(e){return function(e,t){e.logger(">> Request: "+JSON.stringify(t.request,void 0,2)),e.logger(">> Response status code: "+t.status);var r=t.bodyAsText;return e.logger(">> Body: "+r),Promise.resolve(t)}(t,e)}))},t}(G);var Ye=f.HeaderConstants,Xe=function(){function e(e,t){if(void 0===t&&(t="Bearer"),this.authorizationScheme="Bearer",!e)throw new Error("token cannot be null or undefined.");this.token=e,this.authorizationScheme=t}return e.prototype.signRequest=function(e){return e.headers||(e.headers=new n),e.headers.set(Ye.AUTHORIZATION,this.authorizationScheme+" "+this.token),Promise.resolve(e)},e}(),Je=f.HeaderConstants,We=function(){function e(e,t,r){if(void 0===r&&(r="Basic"),this.authorizationScheme="Basic",null==e||"string"!=typeof e.valueOf())throw new Error("userName cannot be null or undefined and must be of type string.");if(null==t||"string"!=typeof t.valueOf())throw new Error("password cannot be null or undefined and must be of type string.");this.userName=e,this.password=t,this.authorizationScheme=r}return e.prototype.signRequest=function(e){var t=this.userName+":"+this.password,r=this.authorizationScheme+" "+btoa(t);return e.headers||(e.headers=new n),e.headers.set(Je.AUTHORIZATION,r),Promise.resolve(e)},e}(),Ge=function(){function e(e){if(!e||e&&!e.inHeader&&!e.inQuery)throw new Error('options cannot be null or undefined. Either "inHeader" or "inQuery" property of the options object needs to be provided.');this.inHeader=e.inHeader,this.inQuery=e.inQuery}return e.prototype.signRequest=function(e){if(!e)return Promise.reject(new Error('webResource cannot be null or undefined and must be of type "object".'));if(this.inHeader)for(var t in e.headers||(e.headers=new n),this.inHeader)e.headers.set(t,this.inHeader[t]);if(this.inQuery){if(!e.url)return Promise.reject(new Error("url cannot be null in the request object."));for(var r in e.url.indexOf("?")<0&&(e.url+="?"),this.inQuery)e.url.endsWith("?")||(e.url+="&"),e.url+=r+"="+this.inQuery[r]}return Promise.resolve(e)},e}(),Ke=function(e){function t(t){if(!t||t&&"string"!=typeof t)throw new Error("topicKey cannot be null or undefined and must be of type string.");var r={inHeader:{"aeg-sas-key":t}};return e.call(this,r)||this}return q(t,e),t}(Ge),Ze=function(e){function t(t){if(!t||t&&"string"!=typeof t)throw new Error("domainKey cannot be null or undefined and must be of type string.");var r={inHeader:{"aeg-sas-key":t}};return e.call(this,r)||this}return q(t,e),t}(Ge);e.ApiKeyCredentials=Ge,e.BaseRequestPolicy=G,e.BasicAuthenticationCredentials=We,e.Constants=f,e.DefaultHttpClient=M,e.DomainCredentials=Ze,e.HttpHeaders=n,e.MapperType=x,e.RequestPolicyOptions=K,e.RestError=H,e.Serializer=E,e.ServiceClient=Le,e.TokenCredentials=Xe,e.TopicCredentials=Ke,e.URLBuilder=ye,e.URLQuery=de,e.WebResource=N,e.agentPolicy=Ie,e.applyMixins=function(e,t){t.forEach((function(t){Object.getOwnPropertyNames(t.prototype).forEach((function(r){e.prototype[r]=t.prototype[r]}))}))},e.delay=v,e.deserializationPolicy=Z,e.deserializeResponseBody=ne,e.encodeUri=function(e){return encodeURIComponent(e).replace(/!/g,"%21").replace(/"/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")},e.executePromisesSequentially=function(e,t){var r=Promise.resolve(t);return e.forEach((function(e){r=r.then(e)})),r},e.exponentialRetryPolicy=oe,e.flattenResponse=$e,e.generateClientRequestIdPolicy=se,e.generateUuid=m,e.getDefaultProxySettings=He,e.getDefaultUserAgentValue=fe,e.isDuration=b,e.isNode=p,e.isValidUuid=y,e.logPolicy=function(e){return void 0===e&&(e=console.log),{create:function(t,r){return new Ve(t,r,e)}}},e.promiseToCallback=function(e){if("function"!=typeof e.then)throw new Error("The provided input is not a Promise.");return function(t){e.then((function(e){t(void 0,e)}),(function(e){t(e)}))}},e.promiseToServiceCallback=function(e){if("function"!=typeof e.then)throw new Error("The provided input is not a Promise.");return function(t){e.then((function(e){process.nextTick(t,void 0,e.parsedBody,e.request,e)}),(function(e){process.nextTick(t,e)}))}},e.proxyPolicy=Me,e.redirectPolicy=_e,e.serializeObject=function e(t){if(null!=t){if(t instanceof Uint8Array)return t=o(t);if(t instanceof Date)return t.toISOString();if(Array.isArray(t)){for(var r=[],n=0;n<t.length;n++)r.push(e(t[n]));return r}if("object"==typeof t){var i={};for(var a in t)i[a]=e(t[a]);return i}return t}},e.signingPolicy=xe,e.stripRequest=d,e.stripResponse=h,e.systemErrorRetryPolicy=Ae,e.throttlingRetryPolicy=ze,e.userAgentPolicy=pe,Object.defineProperty(e,"__esModule",{value:!0})}));